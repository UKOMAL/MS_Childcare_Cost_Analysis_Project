<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>U.S. Childcare Cost Analysis Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #6dd5ed 0%, #2193b0 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .dashboard-container {
            background: rgba(255, 255, 255, 0.97);
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0,0,0,0.15);
            padding: 20px;
            margin-bottom: 20px;
        }
        .control-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .visualization-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            height: 600px;
            position: relative;
        }
        #mainViz {
            width: 100%;
            height: 100%;
        }
        .key-insights {
            background: #f1f9ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="dashboard-container">
            <h2 class="text-center mb-4">U.S. Childcare Cost Analysis Dashboard</h2>
            
            <div class="row">
                <div class="col-md-3">
                    <div class="control-panel">
                        <h4>Dashboard Controls</h4>
                        <div class="mb-3">
                            <label for="dataType" class="form-label">Data Type</label>
                            <select class="form-select" id="dataType">
                                <option value="infant">Infant Care Costs</option>
                                <option value="toddler">Toddler Care Costs</option>
                                <option value="preschool">Preschool Care Costs</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="vizType" class="form-label">Visualization Type</label>
                            <select class="form-select" id="vizType">
                                <option value="map">US Map</option>
                                <option value="bar">Bar Chart</option>
                                <option value="line">Line Chart</option>
                            </select>
                        </div>
                        <button id="updateViz" class="btn btn-primary w-100 mb-2">Update Visualization</button>
                        <button id="exportData" class="btn btn-secondary w-100">Export Data (CSV)</button>
                    </div>
                    
                    <div class="key-insights">
                        <h4>Key Insights</h4>
                        <div class="mb-2">
                            <strong>Average Cost:</strong>
                            <span id="avgCost">$1,260.00</span>
                        </div>
                        <div class="mb-2">
                            <strong>Cost Range:</strong>
                            <span id="costRange">$900 - $1,600</span>
                        </div>
                        <div class="mb-2">
                            <strong>Highest:</strong>
                            <span id="highestState">CA ($1,600)</span>
                        </div>
                        <div class="mb-2">
                            <strong>Lowest:</strong>
                            <span id="lowestState">TX ($900)</span>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-9">
                    <div class="visualization-container">
                        <div id="mainViz" style="width: 100%; height: 100%;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dashboard data
        const globalData = {
            costs: {
                infant: [1600, 1500, 1200, 1300, 1400, 1250, 1100, 1150, 1200, 1100],
                toddler: [1400, 1300, 1000, 1100, 1200, 1050, 900, 950, 1000, 900],
                preschool: [1200, 1100, 800, 900, 1000, 850, 700, 750, 800, 700]
            },
            states: ['CA', 'NY', 'TX', 'FL', 'IL', 'PA', 'OH', 'GA', 'NC', 'MI'],
            stateNames: {
                'CA': 'California', 'NY': 'New York', 'TX': 'Texas', 'FL': 'Florida',
                'IL': 'Illinois', 'PA': 'Pennsylvania', 'OH': 'Ohio', 'GA': 'Georgia',
                'NC': 'North Carolina', 'MI': 'Michigan'
            }
        };

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            updateVisualization();
        });

        // Setup event listeners
        function setupEventListeners() {
            document.getElementById('dataType').addEventListener('change', updateVisualization);
            document.getElementById('vizType').addEventListener('change', updateVisualization);
            document.getElementById('updateViz').addEventListener('click', updateVisualization);
            document.getElementById('exportData').addEventListener('click', exportToCSV);
        }

        // Update visualization
        function updateVisualization() {
            const dataType = document.getElementById('dataType').value;
            const vizType = document.getElementById('vizType').value;
            const data = globalData.costs[dataType];
            const states = globalData.states;

            switch(vizType) {
                case 'map':
                    createMap(data, states);
                    break;
                case 'bar':
                    createBarChart(data, states);
                    break;
                case 'line':
                    createLineChart(data, states);
                    break;
            }

            updateKeyInsights(data, states);
        }

        // Create map visualization
        function createMap(data, states) {
            // Create a map of all US states with default values
            const allStates = {
                'AL': 0, 'AK': 0, 'AZ': 0, 'AR': 0, 'CA': 0, 'CO': 0, 'CT': 0, 'DE': 0,
                'FL': 0, 'GA': 0, 'HI': 0, 'ID': 0, 'IL': 0, 'IN': 0, 'IA': 0, 'KS': 0,
                'KY': 0, 'LA': 0, 'ME': 0, 'MD': 0, 'MA': 0, 'MI': 0, 'MN': 0, 'MS': 0,
                'MO': 0, 'MT': 0, 'NE': 0, 'NV': 0, 'NH': 0, 'NJ': 0, 'NM': 0, 'NY': 0,
                'NC': 0, 'ND': 0, 'OH': 0, 'OK': 0, 'OR': 0, 'PA': 0, 'RI': 0, 'SC': 0,
                'SD': 0, 'TN': 0, 'TX': 0, 'UT': 0, 'VT': 0, 'VA': 0, 'WA': 0, 'WV': 0,
                'WI': 0, 'WY': 0
            };

            // Update values for states we have data for
            states.forEach((state, index) => {
                allStates[state] = data[index];
            });

            const mapData = [{
                type: "choropleth",
                locationmode: "USA-states",
                locations: Object.keys(allStates),
                z: Object.values(allStates),
                text: Object.entries(allStates).map(([state, value]) => 
                    `${state}: ${value > 0 ? '$' + value : 'No data'}`
                ),
                hoverinfo: 'text',
                colorscale: [
                    [0, '#f8f9fa'],
                    [0.2, '#f8d7da'],
                    [0.5, '#e74c3c'],
                    [1, '#7b241c']
                ],
                showscale: true,
                colorbar: {
                    title: "Monthly Cost ($)",
                    thickness: 20,
                    len: 0.5,
                    y: 0.5
                }
            }];

            const layout = {
                title: {
                    text: "Childcare Costs Across United States",
                    font: { size: 24, color: '#2c3e50' }
                },
                geo: {
                    scope: "usa",
                    showlakes: true,
                    lakecolor: "rgb(255,255,255)",
                    projection: {
                        type: "albers usa"
                    },
                    showland: true,
                    landcolor: "#f8f9fa",
                    countrycolor: "#c7c7c7"
                },
                margin: { t: 50, b: 0, l: 0, r: 0 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            Plotly.newPlot('mainViz', mapData, layout);
        }

        // Create bar chart
        function createBarChart(data, states) {
            const barData = [{
                x: states.map(state => globalData.stateNames[state]),
                y: data,
                type: 'bar',
                marker: {
                    color: data.map(value => `rgba(52, 152, 219, ${value/Math.max(...data)})`),
                    line: {
                        color: '#2980b9',
                        width: 1.5
                    }
                },
                hovertemplate: '%{x}<br>$%{y}<extra></extra>'
            }];

            const layout = {
                title: {
                    text: "Childcare Costs by State",
                    font: { size: 24, color: '#2c3e50' }
                },
                xaxis: {
                    title: "State",
                    tickangle: -45
                },
                yaxis: {
                    title: "Monthly Cost ($)",
                    gridcolor: '#e0e0e0'
                },
                margin: { t: 50, b: 100, l: 60, r: 20 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            Plotly.newPlot('mainViz', barData, layout);
        }

        // Create line chart
        function createLineChart(data, states) {
            const lineData = [{
                x: states.map(state => globalData.stateNames[state]),
                y: data,
                type: 'scatter',
                mode: 'lines+markers',
                line: {
                    color: '#2ecc71',
                    width: 3,
                    shape: 'spline'
                },
                marker: {
                    size: 10,
                    color: '#27ae60'
                },
                hovertemplate: '%{x}<br>$%{y}<extra></extra>'
            }];

            const layout = {
                title: {
                    text: "Childcare Costs Trend",
                    font: { size: 24, color: '#2c3e50' }
                },
                xaxis: {
                    title: "State",
                    tickangle: -45
                },
                yaxis: {
                    title: "Monthly Cost ($)",
                    gridcolor: '#e0e0e0',
                    zeroline: false
                },
                margin: { t: 50, b: 100, l: 60, r: 20 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            Plotly.newPlot('mainViz', lineData, layout);
        }

        // Update key insights
        function updateKeyInsights(data, states) {
            const avg = data.reduce((a, b) => a + b) / data.length;
            const max = Math.max(...data);
            const min = Math.min(...data);
            const maxState = states[data.indexOf(max)];
            const minState = states[data.indexOf(min)];

            document.getElementById('avgCost').textContent = `$${avg.toFixed(2)}`;
            document.getElementById('costRange').textContent = `$${min} - $${max}`;
            document.getElementById('highestState').textContent = `${maxState} ($${max})`;
            document.getElementById('lowestState').textContent = `${minState} ($${min})`;
        }

        // Export data to CSV
        function exportToCSV() {
            const dataType = document.getElementById('dataType').value;
            const data = globalData.costs[dataType];
            const states = globalData.states;
            
            let csv = 'State,Cost\n';
            states.forEach((state, i) => {
                csv += `${state},${data[i]}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.setAttribute('hidden', '');
            a.setAttribute('href', url);
            a.setAttribute('download', `childcare_costs_${dataType}.csv`);
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
        }
    </script>
</body>
</html> 